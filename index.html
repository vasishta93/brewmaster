<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BrewMatch by FarmtoCups</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-light: #faf7d0;
      --brand-dark: #000000;
      --highlight: #923028;
      --accent: #3d2d86;
      --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-light);
      color: var(--brand-dark);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .top-bar {
      width: 100%;
      background-color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      border-bottom: 1px solid #e0e0e0;
      box-shadow: var(--box-shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .top-bar img {
      height: 40px;
    }

    .top-bar nav a {
      color: var(--brand-dark);
      margin-left: 20px;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }

    .top-bar nav a:hover {
      color: var(--highlight);
    }

    .banner {
      width: 100%;
      height: 300px;
      background: url('img/banner.png') center/cover no-repeat;
      position: relative;
    }

    header {
      padding: 30px 20px 20px;
      text-align: center;
      background: linear-gradient(to bottom, #fff7e0, var(--bg-light));
      width: 100%;
    }

    header h1 {
      font-family: 'Playfair Display', serif;
      color: var(--brand-dark);
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    header p.subtitle {
      font-size: 1.2rem;
      color: var(--accent);
      margin-bottom: 16px;
    }

    header p.description {
      max-width: 700px;
      margin: 0 auto 30px;
      font-size: 16px;
      line-height: 1.6;
      color: #222;
    }

    .intro-buttons {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
      padding-bottom: 30px;
    }

    .intro-button {
      width: 180px;
      height: 180px;
      background-color: white;
      color: var(--brand-dark);
      border: 2px solid var(--accent);
      border-radius: 20px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: var(--box-shadow);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 16px;
    }

    .intro-button:hover {
      transform: scale(1.05);
      background-color: var(--accent);
      color: white;
    }

    .intro-button img {
      width: 80px;
      height: 80px;
      margin-bottom: 10px;
    }

    .chat-wrapper {
      background-color: #fff;
      width: 100%;
      max-width: 720px;
      border-radius: 16px;
      box-shadow: var(--box-shadow);
      margin: 30px auto;
      padding: 20px;
      display: none;
      flex-direction: column;
      overflow: hidden;
      animation: fadeIn 0.6s ease;
    }

    .chat-container {
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 400px;
      padding-bottom: 10px;
    }

    .message {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      border-radius: 16px;
      max-width: 75%;
      font-size: 15px;
    }

    .bot {
      background-color: #e9e6d2;
      align-self: flex-start;
    }

    .user {
      background-color: var(--highlight);
      color: white;
      align-self: flex-end;
    }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
    }

    .options button,
    .footer-buttons button,
    .input-section button {
      background-color: var(--brand-dark);
      color: #fff;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      margin: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .options button:hover,
    .footer-buttons button:hover,
    .input-section button:hover {
      background-color: var(--highlight);
    }

    .options {
      display: flex;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .input-section {
      display: flex;
      margin-top: 10px;
    }

    .input-section input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      margin-right: 10px;
    }

    .footer-buttons {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
    }

    footer {
      background-color: #fff;
      padding: 20px;
      text-align: center;
      border-top: 1px solid #eee;
      font-size: 14px;
      margin-top: auto;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 600px) {
      .top-bar, .top-bar nav {
        flex-direction: column;
        align-items: flex-start;
      }
      .intro-button {
        width: 140px;
        height: 140px;
        font-size: 14px;
      }
      header h1 {
        font-size: 1.8rem;
      }
      .banner {
        height: 120px;
      }
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <a href="/"><img src="img/logo.png" alt="FarmtoCups Logo"></a>
    <nav>
      <a href="https://www.farmtocups.com">Main Website</a>
      <a href="https://www.farmtocups.com/shop">Shop</a>
    </nav>
  </div>

  <div class="banner"></div>

  <header>
    <h1>â˜• BrewMatch by FarmtoCups</h1>
    <p class="subtitle">Your Mood-Based Brew Guide</p>
    <h1>Not sure what to brew? Weâ€™ve got you</h1>
    <p class="description">
    Not sure what to steep today? Whether youâ€™re looking to unwind, recharge, or simply savour a new flavour, BrewMatch helps you discover the perfect cup.
    Take a short quiz and weâ€™ll recommend blends that suit your current mood â€” or chat with our Brew Master to explore ingredients, brewing tips, and kits curated just for you. Because the right brew isnâ€™t just about taste â€” itâ€™s about how it makes you feel.   
   
    </p>
    <div class="intro-buttons">
      <button class="intro-button" onclick="startQuiz()">
        <img src="img/1.png" alt="Quiz" />
        Take the Brew Quiz
      </button>
      <button class="intro-button" onclick="startChat()">
        <img src="img/2.png" alt="Chat" />
        Chat with Brew Master
      </button>
    </div>
  </header>

  <section class="chat-wrapper" id="chatSection">
    <div id="chatContainer" class="chat-container"></div>
    <div class="input-section" id="brewMasterInputSection">
      <input type="text" id="brewMasterInput" placeholder="Ask the Brew Master anything..." />
      <button onclick="sendToBrewMaster()">Send</button>
    </div>
    <div class="footer-buttons">
      <button id="restartButton" onclick="restart()">Start Over</button>
    </div>
  </section>

  <footer>
    &copy; 2025 FarmtoCups. All rights reserved. | <a href="https://www.farmtocups.com" style="color: var(--accent); text-decoration: none;">Visit Website</a>
  </footer>

  <script>
    const chatSection = document.getElementById('chatSection');
    const chatContainer = document.getElementById('chatContainer');
    const restartButton = document.getElementById('restartButton');
    const brewMasterInputSection = document.getElementById('brewMasterInputSection');
    const brewMasterInput = document.getElementById('brewMasterInput');

    const chatFlow = [
      { question: "When do you usually enjoy your brew?", options: ["Morning", "Afternoon", "Evening", "Night"] },
      { question: "How do you want to feel after the drink?", options: ["Focused", "Relaxed", "Refreshed", "Comforted"] },
      { question: "Choose your ideal brew format", options: ["Hot Infusion", "Iced Brew", "Pour Over", "Cold Brew"] },
      { question: "Which taste notes appeal to you?", options: ["Floral", "Fruity", "Earthy", "Bold"] },
      { question: "Whatâ€™s your current mood?", options: ["Adventurous", "Tired", "Celebratory", "Stressed", "Chill"] }
    ];

    let currentStep = 0;
    const userResponses = [];

    function addMessage(text, sender = 'bot') {
      const msg = document.createElement('div');
      msg.classList.add('message', sender);
      const avatar = document.createElement('img');
      avatar.className = 'avatar';
      avatar.src = sender === 'bot' ? 'img/4.png' : 'img/6.png';
      const span = document.createElement('span');
      span.textContent = text;
      msg.appendChild(avatar);
      msg.appendChild(span);
      chatContainer.appendChild(msg);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function showOptions(options) {
      const buttonWrapper = document.createElement('div');
      buttonWrapper.classList.add('options');
      options.forEach(opt => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => {
          addMessage(opt, 'user');
          userResponses.push(opt);
          currentStep++;
          nextQuestion();
        };
        buttonWrapper.appendChild(btn);
      });
      chatContainer.appendChild(buttonWrapper);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function nextQuestion() {
      if (currentStep < chatFlow.length) {
        addMessage(chatFlow[currentStep].question);
        showOptions(chatFlow[currentStep].options);
      } else {
        generateRecommendation();
      }
    }

    async function generateRecommendation() {
      addMessage("Thinking...");
      const formattedInput = `Time: ${userResponses[0]}, Desired Effect: ${userResponses[1]}, Format: ${userResponses[2]}, Taste: ${userResponses[3]}, Mood: ${userResponses[4]}`;
      const prompt = `You are BrewBot, a barrista AI beverage guide from FarmtoCups.
		Your task is to recommend 3 drinks made exclusively with FarmtoCups ingredients. These include:
		Blue Pea Flower
		Hibiscus Flower
		Chamomile Flower
		Robusta Coffee (Thaimala Roast)
		Natural additions like mint, lemongrass, ginger, cardamom, cinnamon, orange, vanilla, honey, and seasonal fruits.

		The user has the following preferences:
		${formattedInput}

		Recommend 2 drinks made ONLY using FarmtoCups ingredients. For each drink, provide:
		Drink Name
		Flavor: (short sensory description)
		How to Make: (clear, 1-line method using available ingredients)
    dont use mark down or emoji and please format the recipie nicely 

		At the end, suggest a FarmtoCups product bundle or starter kit the user should try based on your drink recommendations. Suggest from options like:
		Indraneelam Blend | Blue Pea Flower Infusion
		Nidranjali Blend | Chamomile Herbal Infusion
		Sembaruthi Blend | Hibiscus Floral Infusion
		Floral Infusion Starter Kit (includes all 3 teas + infuser + cup)
		Self-Brew Coffee Kit (glass pour-over cup + Thaimala Roast + filters)
		Cold Brew Kit (Robusta coffee + cold brew pouch + recipe)

		Do NOT suggest anything not sold by FarmtoCups. Keep the tone sensory, warm, and wiseâ€”like a trusted brew master inviting someone into the world of craft beverages.`;
      try {
        const res = await fetch("/.netlify/functions/getBrewResponse", {
		  method: "POST",
		  headers: {
			"Content-Type": "application/json"
		  },
		  body: JSON.stringify({ prompt })
		});
        const data = await res.json();
        chatContainer.lastChild.remove();
        data.choices[0].message.content.split('\n')
		.filter(msg => msg.trim() !== '')
		.forEach(msg => addMessage(msg));
        restartButton.style.display = 'block';
      } catch (error) {
        chatContainer.lastChild.remove();
        addMessage("Oops! Something went wrong. Please try again.");
      }
    }

    function sendToBrewMaster() {
      const question = brewMasterInput.value.trim();
      if (!question) return;
      addMessage(question, 'user');
      brewMasterInput.value = '';
      addMessage("Brew Master is thinking...");

      const refinedPrompt =  `You are BrewMaster, a professional barrista and beverage guide from FarmtoCups. Always ask questions and be less talkative.
			You help users make the most of their tea and coffee experiences using only FarmtoCups products. Your tone is calm, warm, and sensoryâ€”like a slow, meaningful conversation over a cup of tea.
      Always welcome the user, ask them questions and make them feel welcome and dont be too salesy. Dont keep pushing them to use farmtocups from get, just help them with what they want first and then subtly ask them to buy.

			âœ¨ You can help users:
			- Brew the perfect drink based on how they feel, the time of day, or what theyâ€™ve purchased
			- Decide which blend or kit suits them next
			- Understand how to use our kits and infusions
			- Suggest brewing methods (hot, cold, iced, frothy) using FarmtoCups ingredients only

			ðŸŒ¿ FarmtoCups Products You Can Recommend:
			- Indraneelam Blend (Blue Pea Flower Infusion) 
			- Nidranjali Blend (Chamomile Herbal Infusion)
			- Sembaruthi Blend (Hibiscus Floral Infusion)
      - Thaimala Roast (Robusta Speclity Coffee)
			- Floral Infusion Starter Kit (All 3 blends + infuser + cup)
			- Self-Brew Coffee Kit (Glass pour-over cup + Thaimala Roast + filters)
			- Cold Brew Kit (Robusta coffee + cold brew pouch + recipe)

			ðŸŒ± Core Ingredients:
			- Blue Pea Flower, Hibiscus Flower, Chamomile Flower
			- Robusta Coffee (Thaimala Roast)
			- Natural additions like mint, lemongrass, cardamom, cinnamon, orange peel, vanilla, honey, ginger, etc.

			ðŸ’¡ What NOT to Do:
      - Use markdown in responses
			- NEVER suggest anything not sold by FarmtoCups (no green tea, dairy, soda, alcohol, or matcha)
			- NEVER recommend generic products
			- DO NOT push salesâ€”guide gently through storytelling, rituals, sensory notes

			

			Always be helpful. Always be warm. Dont Yap too much, You're the BrewMaster from FarmtoCups. 

      User asks: ${question}`;

      fetch("/.netlify/functions/getBrewResponse", {
		  method: "POST",
		  headers: {
			"Content-Type": "application/json"
		  },
		  body: JSON.stringify({ prompt: refinedPrompt })
		})
      .then(res => res.json())
      .then(data => {
        chatContainer.lastChild.remove();
		data.choices[0].message.content.split('\n')
		.filter(msg => msg.trim() !== '')
		.forEach(msg => addMessage(msg));
      })
      .catch(() => {
        chatContainer.lastChild.remove();
        addMessage("Something went wrong while talking to the Brew Master.");
      });
    }

    function startQuiz() {
      chatSection.style.display = 'flex';
      brewMasterInputSection.style.display = 'none';
      chatContainer.innerHTML = '';
      addMessage("Let's find your perfect drink with a quick quiz!");
      currentStep = 0;
      userResponses.length = 0;
      nextQuestion();
    }

    function startChat() {
      chatSection.style.display = 'flex';
      brewMasterInputSection.style.display = 'flex';
      chatContainer.innerHTML = '';
      addMessage("I'm the Brew Master. Ask me anything about your perfect brew.");
    }

    function restart() {
      chatSection.style.display = 'none';
      chatContainer.innerHTML = '';
    }
  </script>
</body>
</html>